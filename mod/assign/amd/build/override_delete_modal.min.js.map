{"version":3,"file":"override_delete_modal.min.js","sources":["../src/override_delete_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Modal for deleting an override with the option to recalculate penalties.\n *\n * @module     mod_assign/override_delete_modal\n * @copyright  2025 Catalyst IT Australia Pty Ltd\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as CustomEvents from 'core/custom_interaction_events';\nimport Modal from 'core/modal';\n\nconst SELECTORS = {\n    DELETE_BUTTONS: '.delete-override',\n    RECACULATION_CHECKBOX: '#recalculatepenalties',\n};\n\n/**\n * Custom Modal\n */\nexport default class OverrideDeleteModal extends Modal {\n    static TYPE = \"mod_assign/override_delete_modal\";\n    static TEMPLATE = \"mod_assign/override_delete_modal\";\n\n    /**\n     * Configure the modal.\n     *\n     * @param {Object} modalConfig\n     */\n    configure(modalConfig) {\n        // Add question modals are always large.\n        modalConfig.large = true;\n\n        // Always show on creation.\n        modalConfig.show = false;\n        modalConfig.removeOnClose = true;\n\n        // Apply standard configuration.\n        super.configure(modalConfig);\n    }\n\n    /**\n     * Constructor.\n     * Set required data to null.\n     *\n     * @param {HTMLElement} root\n     */\n    constructor(root) {\n        super(root);\n\n        // Recalculate penalties checkbox.\n        this.recalculationCheckbox = this.getModal().find(SELECTORS.RECACULATION_CHECKBOX);\n\n        // Data.\n        this.setOverrideId(null);\n        this.setSessionKey(null);\n    }\n\n    /**\n     * Set the override id.\n     *\n     * @param {number} id The override id.\n     */\n    setOverrideId(id) {\n        this.overrideId = id;\n    }\n\n    /**\n     * Get the override id.\n     *\n     * @returns {*}\n     */\n    getOverrideId() {\n        return this.overrideId;\n    }\n\n    /**\n     * Set the session key.\n     *\n     * @param {string} key\n     */\n    setSessionKey(key) {\n        this.sessionKey = key;\n    }\n\n    /**\n     * Get the session key.\n     *\n     * @returns {*}\n     */\n    getSessionKey() {\n        return this.sessionKey;\n    }\n\n    /**\n     * Register events.\n     *\n     */\n    registerEventListeners() {\n        // Apply parent event listeners.\n        super.registerEventListeners(this);\n\n        // Register to close on cancel.\n        this.registerCloseOnCancel();\n\n        // Register the delete action.\n        this.getModal().on(CustomEvents.events.activate, this.getActionSelector('delete'), () => {\n            this.deleteOverride();\n        });\n    }\n\n    /**\n     * Delete a override.\n     *\n     */\n    deleteOverride() {\n        // Check if the recalculation checkbox is checked.\n        const recalculate = this.recalculationCheckbox.prop('checked');\n\n        // Redirect to the delete URL.\n        window.location.href = M.cfg.wwwroot + '/mod/assign/overridedelete.php?id=' + this.getOverrideId() +\n            '&sesskey=' + this.getSessionKey() + '&confirm=1'\n            + (recalculate ? '&recalculate=1' : '');\n    }\n}\n\nOverrideDeleteModal.registerModalType();\n"],"names":["SELECTORS","OverrideDeleteModal","Modal","configure","modalConfig","large","show","removeOnClose","constructor","root","recalculationCheckbox","this","getModal","find","setOverrideId","setSessionKey","id","overrideId","getOverrideId","key","sessionKey","getSessionKey","registerEventListeners","registerCloseOnCancel","on","CustomEvents","events","activate","getActionSelector","deleteOverride","recalculate","prop","window","location","href","M","cfg","wwwroot","registerModalType"],"mappings":"+3CA0BMA,gCAEqB,8BAMNC,4BAA4BC,eAS7CC,UAAUC,aAENA,YAAYC,OAAQ,EAGpBD,YAAYE,MAAO,EACnBF,YAAYG,eAAgB,QAGtBJ,UAAUC,aASpBI,YAAYC,YACFA,WAGDC,sBAAwBC,KAAKC,WAAWC,KAAKb,sCAG7Cc,cAAc,WACdC,cAAc,MAQvBD,cAAcE,SACLC,WAAaD,GAQtBE,uBACWP,KAAKM,WAQhBF,cAAcI,UACLC,WAAaD,IAQtBE,uBACWV,KAAKS,WAOhBE,+BAEUA,uBAAuBX,WAGxBY,6BAGAX,WAAWY,GAAGC,aAAaC,OAAOC,SAAUhB,KAAKiB,kBAAkB,WAAW,UAC1EC,oBAQbA,uBAEUC,YAAcnB,KAAKD,sBAAsBqB,KAAK,WAGpDC,OAAOC,SAASC,KAAOC,EAAEC,IAAIC,QAAU,qCAAuC1B,KAAKO,gBAC/E,YAAcP,KAAKU,gBAAkB,cAClCS,YAAc,iBAAmB,iEAtG3B7B,2BACH,oDADGA,+BAEC,oCAwGtBA,oBAAoBqC"}